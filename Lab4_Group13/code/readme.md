与GPT交流得到的工作流程:

先用棋盘 标定相机内参 + 立体外参（R, T），然后用该“已标定”的相机参数去对任意目标物体的左右图像做 3D 重建（稀疏或稠密），得到有量纲的点云。

1. 标定（得到 metric intrinsics + extrinsics）用 N 对棋盘左右图像（覆盖不同视角/深度）运行标定

2. 采集目标物体的同步左右图像（与标定时相同的相机设置：分辨率、曝光、增益、对焦）
放置物体到视野内，拍一组或多组左右对

3. 用已标定得到的 R,T 和相机内参，把对应匹配点三角测量得到 3D 点云

# 使用说明

`calibration.py`：相机标定脚本，输入棋盘格图片，输出相机内参和立体外参。

`undistort.py`：图像校正脚本，输入左右图像和标定参数，输出校正后的图像。

`depth_ply.py`：深度图和点云生成脚本，输入校正后的左右图像和标定参数，输出深度图和PLY格式的点云文件。

关于点云生成部分：

详细询问了AI, 查阅了部分资料对比，  发觉`reprojectImageTo3D`所需的Q(重投影矩阵)有问题（[点我跳转](https://forum.opencv.org/t/erroneous-point-cloud-generated-by-cv2-reprojectimageto3d/3706/4) ）

自己检查code， 发觉生成Q是函数`cv2.stereoRectify`生成的，但该函数生成的Q是有误的， 但是我找了很久没看到是哪里错误了 就去查资料手动写了Q的计算矩阵

目前效果比较差， 但是可以通过截图画弧线来引导读者（点云大致还是能看出形状的）

# 建议

参数对于深度图和点云的效果影响巨大， 建议多尝试不同的参数组合以获得最佳效果。